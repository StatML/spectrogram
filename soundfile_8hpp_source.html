<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>spectrogram: soundfile.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>soundfile.hpp</h1>  </div>
</div>
<div class="contents">
<a href="soundfile_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifndef SOUNDFILE_HPP</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">#define SOUNDFILE_HPP</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span>
<a name="l00007"></a>00007 <span class="preprocessor">#include &lt;QString&gt;</span>
<a name="l00008"></a>00008 <span class="preprocessor">#include &lt;QFile&gt;</span>
<a name="l00009"></a>00009 <span class="preprocessor">#include &lt;vector&gt;</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &lt;sndfile.hh&gt;</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include &quot;<a class="code" href="types_8hpp.html" title="Contains definitions for basic types and constants.">types.hpp</a>&quot;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &quot;mad.h&quot;</span>
<a name="l00013"></a>00013 
<a name="l00015"></a>00015 
<a name="l00016"></a><a class="code" href="class_soundfile_data.html">00016</a> <span class="keyword">class </span><a class="code" href="class_soundfile_data.html" title="An abstract interface for decoding sound files.">SoundfileData</a>
<a name="l00017"></a>00017 {
<a name="l00018"></a>00018     <span class="keyword">public</span>:
<a name="l00019"></a><a class="code" href="class_soundfile_data.html#a14e349e95882d3c31a6ef6ad4451e03e">00019</a>         <span class="keyword">virtual</span> <a class="code" href="class_soundfile_data.html#a14e349e95882d3c31a6ef6ad4451e03e">~SoundfileData</a>() {};
<a name="l00021"></a>00021         <span class="keyword">virtual</span> QString <a class="code" href="class_soundfile_data.html#aa5c3c7188d43c57b5920f23436a521b4" title="Used to get details in case of an error.">error</a>() <span class="keyword">const</span> = 0;
<a name="l00023"></a>00023         <span class="keyword">virtual</span> <a class="code" href="types_8hpp.html#a53e840bbf4a4409ccf0d427ae027b10e">real_vec</a> <a class="code" href="class_soundfile_data.html#a0c733ccd7692f9a2b771d5d3bb5b2b2d" title="Loads a specified channel into a real-valued vector.">read_channel</a>(<span class="keywordtype">int</span> channel) = 0;
<a name="l00025"></a>00025         <span class="keyword">virtual</span> <span class="keywordtype">size_t</span> <a class="code" href="class_soundfile_data.html#a3df7bdc185542ac3b62465d4f295a9ea" title="Returns the number of audio frames in each channel.">frames</a>() <span class="keyword">const</span> = 0;
<a name="l00027"></a>00027         <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="class_soundfile_data.html#ac613ce217f3d234ca569b90cd3c85b4e" title="Returns the length of the audio track in seconds.">length</a>() <span class="keyword">const</span> = 0;
<a name="l00029"></a>00029         <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="class_soundfile_data.html#aed486339028ddc30cf9ce2bd6fcff9bb" title="Returns the samplerate of the audio file in Hz.">samplerate</a>() <span class="keyword">const</span> = 0;
<a name="l00031"></a>00031         <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="class_soundfile_data.html#a671d9d2f3a87576c3673aba226c61cee" title="Returns the number of channels.">channels</a>() <span class="keyword">const</span> = 0;
<a name="l00033"></a>00033         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="class_soundfile_data.html#ac0daba760932745e6310ef6805a4e764" title="Checks if the audio file is loaded correctly and ready for use.">valid</a>() <span class="keyword">const</span> = 0;
<a name="l00034"></a>00034 };
<a name="l00035"></a>00035 
<a name="l00037"></a>00037 
<a name="l00038"></a><a class="code" href="class_sndfile_data.html">00038</a> <span class="keyword">class </span><a class="code" href="class_sndfile_data.html" title="Implements the SoundfileData interface using libsndfile.">SndfileData</a> : <span class="keyword">public</span> <a class="code" href="class_soundfile_data.html" title="An abstract interface for decoding sound files.">SoundfileData</a>
<a name="l00039"></a>00039 {
<a name="l00040"></a>00040     <span class="keyword">public</span>:
<a name="l00041"></a>00041         <a class="code" href="class_sndfile_data.html#a995602344fe7c7fc3c36b3a6c70bb40b">SndfileData</a>(<span class="keyword">const</span> QString&amp; fname);
<a name="l00042"></a>00042         <a class="code" href="class_sndfile_data.html#abf281bae2816835e5ef9a604622ed627">~SndfileData</a>();
<a name="l00043"></a>00043         QString <a class="code" href="class_sndfile_data.html#a5def924f9d35b90dfc1de04f41c18938" title="Used to get details in case of an error.">error</a>() <span class="keyword">const</span>;
<a name="l00044"></a>00044         <a class="code" href="types_8hpp.html#a53e840bbf4a4409ccf0d427ae027b10e">real_vec</a> <a class="code" href="class_sndfile_data.html#acaaa7839b4b347154b08b8c71d0f1b62" title="Loads a specified channel into a real-valued vector.">read_channel</a>(<span class="keywordtype">int</span> channel);
<a name="l00045"></a>00045         <span class="keywordtype">size_t</span> <a class="code" href="class_sndfile_data.html#aeece02f80516660aee205eb5baa83381" title="Returns the number of audio frames in each channel.">frames</a>() <span class="keyword">const</span>;
<a name="l00046"></a>00046         <span class="keywordtype">double</span> <a class="code" href="class_sndfile_data.html#a27b7d9dd9540d577ebb5e7f180ce652b" title="Returns the length of the audio track in seconds.">length</a>() <span class="keyword">const</span>; <span class="comment">//in seconds</span>
<a name="l00047"></a>00047         <span class="keywordtype">int</span> <a class="code" href="class_sndfile_data.html#a75864d80c62c3beef42a2431ea53af82" title="Returns the samplerate of the audio file in Hz.">samplerate</a>() <span class="keyword">const</span>;
<a name="l00048"></a>00048         <span class="keywordtype">int</span> <a class="code" href="class_sndfile_data.html#ad08d35eb8a478796036c02dabbe5a2b5" title="Returns the number of channels.">channels</a>() <span class="keyword">const</span>;
<a name="l00049"></a>00049         <span class="keywordtype">bool</span> <a class="code" href="class_sndfile_data.html#a77024fc9cc9cd91ac10ad5d4bfa530f3" title="Checks if the audio file is loaded correctly and ready for use.">valid</a>() <span class="keyword">const</span>;
<a name="l00050"></a>00050     <span class="keyword">private</span>:
<a name="l00051"></a>00051         SndfileHandle file_;
<a name="l00052"></a>00052 };
<a name="l00053"></a>00053 
<a name="l00055"></a>00055 
<a name="l00056"></a><a class="code" href="class_m_p3_data.html">00056</a> <span class="keyword">class </span><a class="code" href="class_m_p3_data.html" title="Implements the SoundfileData interface using libmad.">MP3Data</a> : <span class="keyword">public</span> <a class="code" href="class_soundfile_data.html" title="An abstract interface for decoding sound files.">SoundfileData</a>
<a name="l00057"></a>00057 {
<a name="l00058"></a>00058     <span class="keyword">public</span>:
<a name="l00059"></a>00059         <a class="code" href="class_m_p3_data.html#a55f71a9c9a4fe0a838c40947d7d7b50d">MP3Data</a>(<span class="keyword">const</span> QString&amp; fname);
<a name="l00060"></a>00060         QString <a class="code" href="class_m_p3_data.html#a77b6c5bf029968fd9ad915de11c0f9a4" title="Used to get details in case of an error.">error</a>() <span class="keyword">const</span>;
<a name="l00061"></a>00061         <a class="code" href="types_8hpp.html#a53e840bbf4a4409ccf0d427ae027b10e">real_vec</a> <a class="code" href="class_m_p3_data.html#a6191cab00d6ea94f44c157a993075281" title="Loads a specified channel into a real-valued vector.">read_channel</a>(<span class="keywordtype">int</span> channel);
<a name="l00062"></a>00062         <span class="keywordtype">size_t</span> <a class="code" href="class_m_p3_data.html#a8da2e71dc396744b54601b7858f82546" title="Returns the number of audio frames in each channel.">frames</a>() <span class="keyword">const</span>;
<a name="l00063"></a>00063         <span class="keywordtype">double</span> <a class="code" href="class_m_p3_data.html#a949169227b3a56b487e1ca6875d3d807" title="Returns the length of the audio track in seconds.">length</a>() <span class="keyword">const</span>;<span class="comment">//in seconds</span>
<a name="l00064"></a>00064         <span class="keywordtype">int</span> <a class="code" href="class_m_p3_data.html#a69600cebfe9617baa610b119614e5e08" title="Returns the samplerate of the audio file in Hz.">samplerate</a>() <span class="keyword">const</span>;
<a name="l00065"></a>00065         <span class="keywordtype">int</span> <a class="code" href="class_m_p3_data.html#a1c9a99bd11e950ccbae1f5d805a33372" title="Returns the number of channels.">channels</a>() <span class="keyword">const</span>;
<a name="l00066"></a>00066         <span class="keywordtype">bool</span> <a class="code" href="class_m_p3_data.html#a053c2544f990f1e76e5b538ea493b18b" title="Checks if the audio file is loaded correctly and ready for use.">valid</a>() <span class="keyword">const</span>;
<a name="l00067"></a>00067     <span class="keyword">private</span>:
<a name="l00068"></a>00068         <span class="keywordtype">void</span> get_mp3_stats();
<a name="l00069"></a>00069         <span class="keywordtype">size_t</span> frames_;
<a name="l00070"></a>00070         <span class="keywordtype">size_t</span> length_;
<a name="l00071"></a>00071         <span class="keywordtype">int</span> samplerate_;
<a name="l00072"></a>00072         <span class="keywordtype">int</span> channels_;
<a name="l00073"></a>00073         QString filename_;
<a name="l00074"></a>00074         QString error_;
<a name="l00075"></a>00075 };
<a name="l00076"></a>00076 
<a name="l00078"></a>00078 
<a name="l00079"></a><a class="code" href="class_soundfile.html">00079</a> <span class="keyword">class </span><a class="code" href="class_soundfile.html" title="A format-independent class that provides functionality for sound manipulation, reading and writing...">Soundfile</a>
<a name="l00080"></a>00080 {
<a name="l00081"></a>00081     <span class="keyword">public</span>:
<a name="l00083"></a>00083 
<a name="l00085"></a>00085         <span class="keyword">static</span> QString <a class="code" href="class_soundfile.html#ab5e8f5e642e183b1b55475ae434a4cde" title="Writes pcm data to an audio file encoded according to the extension.">writeSound</a>(<span class="keyword">const</span> QString&amp; fname, <span class="keyword">const</span> <a class="code" href="types_8hpp.html#a53e840bbf4a4409ccf0d427ae027b10e">real_vec</a>&amp; <a class="code" href="class_soundfile.html#a1480f41a7808c1becfd7f7642a6bd540" title="Allows access to low-level information about the file (eg. samplerate).">data</a>,
<a name="l00086"></a>00086                 <span class="keywordtype">int</span> samplerate, <span class="keywordtype">int</span> format=-1);
<a name="l00087"></a>00087         <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="class_soundfile.html#af47cd67d33afc1e4a41812f9abedd1e7" title="Returns the format specification guessed from the specified file extension.">guessFormat</a>(<span class="keyword">const</span> QString&amp; filename);
<a name="l00088"></a>00088 
<a name="l00089"></a>00089         <a class="code" href="class_soundfile.html#a7acf01d9ba196bf8eb9b2219c1f92fef">Soundfile</a>();
<a name="l00090"></a>00090         <a class="code" href="class_soundfile.html#a7acf01d9ba196bf8eb9b2219c1f92fef">Soundfile</a>(<span class="keyword">const</span> QString&amp; fname);
<a name="l00092"></a>00092         <span class="keywordtype">void</span> <a class="code" href="class_soundfile.html#afedbacb8acb5daca9361c938df60564a" title="Forget the loaded file.">reset</a>();
<a name="l00094"></a>00094         <span class="keywordtype">void</span> <a class="code" href="class_soundfile.html#a19f151a7608263618c5b43b5a50c028c" title="Loads the specified file.">load</a>(<span class="keyword">const</span> QString&amp; fname);
<a name="l00096"></a>00096         <span class="keyword">const</span> QString&amp; <a class="code" href="class_soundfile.html#a6be9a3ce14852889f63f12a805505abd" title="If the loaded file isn&amp;#39;t valid, this function gives the reason.">error</a>() <span class="keyword">const</span>;
<a name="l00098"></a>00098         <span class="keywordtype">bool</span> <a class="code" href="class_soundfile.html#a76bd03c0f0d3de0df1c9511d416670cd" title="Used to determine if a file was loaded successfully.">valid</a>() <span class="keyword">const</span>;
<a name="l00100"></a>00100 
<a name="l00101"></a>00101         <a class="code" href="types_8hpp.html#a53e840bbf4a4409ccf0d427ae027b10e">real_vec</a> <a class="code" href="class_soundfile.html#a13be4c000d5eb8c0f400f279b4b89ed5" title="Read the audio data of the given channel from the loaded file.">read_channel</a>(<span class="keywordtype">int</span> channel);
<a name="l00103"></a>00103         <span class="keyword">const</span> <a class="code" href="class_soundfile_data.html" title="An abstract interface for decoding sound files.">SoundfileData</a>&amp; <a class="code" href="class_soundfile.html#a1480f41a7808c1becfd7f7642a6bd540" title="Allows access to low-level information about the file (eg. samplerate).">data</a>() <span class="keyword">const</span>;
<a name="l00104"></a>00104     <span class="keyword">private</span>:
<a name="l00105"></a>00105         <a class="code" href="class_soundfile_data.html" title="An abstract interface for decoding sound files.">SoundfileData</a>* data_;
<a name="l00106"></a>00106         QString error_;
<a name="l00107"></a>00107 };
<a name="l00108"></a>00108 
<a name="l00109"></a>00109 <span class="preprocessor">#endif</span>
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
